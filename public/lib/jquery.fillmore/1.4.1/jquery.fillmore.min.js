/*!
 * jQuery Fillmore
 * Version 1.4.1
 * https://github.com/gregjacobs/jquery-fillmore
 *
 * Add a dynamically-resized background image to any element
 *
 * Copyright (c) 2012 Gregory Jacobs with Aidan Feldman (jux.com)
 * Dual licensed under the MIT and GPL licenses.
 */
(function(a){a.Fillmore=function(c){this.init(c)};a.Fillmore.defaultSettings={src:null,focusX:50,focusY:50,speed:0,onImageLoad:undefined,onImageVisible:undefined,callback:undefined};var b=function(ah,ag,af){function H(c){Z.cssText=c}function G(d,c){return H(prefixes.join(d+";")+(c||""))}function F(d,c){return typeof d===c}function E(d,c){return !!~(""+d).indexOf(c)}function S(f,c){for(var h in f){var g=f[h];if(!E(g,"-")&&Z[g]!==af){return c=="pfx"?g:!0}}return !1}function Q(g,c,j){for(var i in g){var h=c[g[i]];if(h!==af){return j===!1?g[i]:F(h,"function")?h.bind(j||c):h}}return !1}function O(g,f,j){var i=g.charAt(0).toUpperCase()+g.slice(1),h=(g+" "+V.join(i+" ")+i).split(" ");return F(f,"string")||F(f,"undefined")?S(h,f):(h=(g+" "+U.join(i+" ")+i).split(" "),Q(h,f,j))}var ae="2.6.2",ad={},ac=ag.documentElement,ab="modernizr",aa=ag.createElement(ab),Z=aa.style,Y,X={}.toString,W="Webkit Moz O ms",V=W.split(" "),U=W.toLowerCase().split(" "),T={},R={},P={},N=[],M=N.slice,K,J={}.hasOwnProperty,I;!F(J,"undefined")&&!F(J.call,"undefined")?I=function(d,c){return J.call(d,c)}:I=function(d,c){return c in d&&F(d.constructor.prototype[c],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(f){var i=this;if(typeof i!="function"){throw new TypeError}var h=M.call(arguments,1),g=function(){if(this instanceof g){var c=function(){};c.prototype=i.prototype;var e=new c,d=i.apply(e,h.concat(M.call(arguments)));return Object(d)===d?d:e}return i.apply(f,h.concat(M.call(arguments)))};return g}),T.backgroundsize=function(){return O("backgroundSize")};for(var L in T){I(T,L)&&(K=L.toLowerCase(),ad[K]=T[L](),N.push((ad[K]?"":"no-")+K))}return ad.addTest=function(e,c){if(typeof e=="object"){for(var f in e){I(e,f)&&ad.addTest(f,e[f])}}else{e=e.toLowerCase();if(ad[e]!==af){return ad}c=typeof c=="function"?c():c,typeof enableClasses!="undefined"&&enableClasses&&(ac.className+=" "+(c?"":"no-")+e),ad[e]=c}return ad},H(""),aa=Y=null,ad._version=ae,ad._domPrefixes=U,ad._cssomPrefixes=V,ad.testProp=function(c){return S([c])},ad.testAllProps=O,ad}(this,this.document);a.Fillmore.useCss3=b.backgroundsize&&!/i(Phone|Pod|Pad).*OS 4_/.test(window.navigator.userAgent);a.extend(a.Fillmore.prototype,{fillmoreElPosition:"absolute",imageLoaded:false,imageVisible:false,init:function(d){this.settings=a.extend({},a.Fillmore.defaultSettings);var c=this.$containerEl=a(d);c.css("background","transparent");if(c.is("body")){this.fillmoreElPosition="fixed"}else{this.originalContainerOverflow=c[0].style.overflow;c.css("overflow","hidden");if(c.css("position")==="static"){c.css("position","relative");this.containerPositionModified=true}if(c.css("z-index")==="auto"){c.css("z-index",0);this.containerZIndexModified=true}}if(this.$containerEl.is("body")){this.$containerSizingEl=("onorientationchange" in window)?a(document):a(window)}else{this.$containerSizingEl=this.$containerEl}this.createFillmoreEl()},createFillmoreEl:function(){this.$fillmoreEl=a('<div class="fillmoreInner" style="left: 0; top: 0; position: '+this.fillmoreElPosition+'; overflow: hidden; z-index: -999999; margin: 0; padding: 0; height: 100%; width: 100%;" />').appendTo(this.$containerEl)},updateSettings:function(c){this.settings=a.extend(this.settings,c)},getSrc:function(){return this.settings.src},getImageEl:function(){throw new Error("getImageEl() must be implemented in subclass")},getImageSize:function(){if(!this.imageLoaded){return null}else{var c=this.getImageEl()[0];return{width:c.width,height:c.height}}},calculateStretchedSizeAndOffsets:function(){var p=this.getImageEl(),d=p[0];p.css({width:"auto",height:"auto"});var j=d.width||p.width(),l=d.height||p.height(),g=j/l,h=this.settings,i=this.$containerEl,k=this.$containerSizingEl,o=k.outerHeight()||k.height(),m=k.outerWidth()||k.width(),f=0,e=0,n=m,c=n/g;if(c>=o){e=(c-o)*this.settings.focusY/100}else{c=o;n=c*g;f=(n-m)*this.settings.focusX/100}return{offsetLeft:f,offsetTop:e,stretchedWidth:n,stretchedHeight:c}},getViewableImageArea:function(){if(!this.imageLoaded){return null}else{var c=this.$containerEl,d=this.calculateStretchedSizeAndOffsets();return{width:c.innerWidth(),height:c.innerHeight(),offsetLeft:d.offsetLeft,offsetTop:d.offsetTop,stretchedWidth:d.stretchedWidth,stretchedHeight:d.stretchedHeight}}},showImage:function(c){this.imageLoaded=false;this.imageVisible=false;this.loadImage(c)},loadImage:function(){throw new Error("loadImage() must be implemented in subclass")},isLoaded:function(){return this.imageIsVisible()},imageIsLoaded:function(){return this.imageLoaded},imageIsVisible:function(){return this.imageVisible},resize:function(){throw new Error("resize() must be implemented in subclass")},onImageLoad:function(c){this.imageLoaded=true;var d=this.settings.onImageLoad;if(typeof d==="function"){d()}if(this.settings.speed){this.$fillmoreEl.hide().fadeIn(this.settings.speed,a.proxy(this.onImageVisible,this));this.settings.speed=0}else{this.onImageVisible()}},onImageVisible:function(e){this.imageVisible=true;var c=this.settings,d=c.onImageVisible||c.callback;if(typeof d==="function"){d()}},destroy:function(){if(this.containerPositionModified){this.$containerEl.css("position","")}if(this.containerZIndexModified){this.$containerEl.css("z-index","")}this.$containerEl.css("overflow",this.originalContainerOverflow);this.$fillmoreEl.remove()}})})(jQuery);(function(a){a.FillmoreCss3=function(b){a.Fillmore.apply(this,arguments)};a.extend(a.FillmoreCss3.prototype,a.Fillmore.prototype,{$imgEl:null,createFillmoreEl:function(){a.Fillmore.prototype.createFillmoreEl.apply(this,arguments);this.$fillmoreEl.css({"background-repeat":"no-repeat","background-size":"cover"})},updateSettings:function(b){a.Fillmore.prototype.updateSettings.apply(this,arguments);this.$fillmoreEl.css("background-position",this.settings.focusX+"% "+this.settings.focusY+"%")},getImageEl:function(){return this.$imgEl||null},resize:function(){},loadImage:function(b){this.$imgEl=a("<img />").bind("load error",a.proxy(this.onImageLoad,this));this.$imgEl.attr("src",b)},onImageLoad:function(b){var c=this.$imgEl[0].src;this.$fillmoreEl.css("background-image","url('"+c+"')");a.Fillmore.prototype.onImageLoad.apply(this,arguments)}})})(jQuery);(function(a){a.FillmoreImageStretch=function(b){a.Fillmore.apply(this,arguments)};a.extend(a.FillmoreImageStretch.prototype,a.Fillmore.prototype,{$imgEl:null,$oldImage:null,init:function(b){a.Fillmore.prototype.init.apply(this,arguments);this.resizeProxy=a.proxy(this.resize,this);a(window).resize(this.resizeProxy)},getImageEl:function(){return this.$imgEl||null},loadImage:function(b){this.$oldImage=this.$imgEl;this.$imgEl=a('<img style="position: absolute; margin: 0; padding: 0; border: none; z-index: -999999;" />').bind("load error",a.proxy(this.onImageLoad,this)).appendTo(this.$fillmoreEl);this.$imgEl.attr("src",b)},onImageLoad:function(b){var c=b.target,d=this.getImageEl();if(c!==d[0]){return}if(this.$oldImage){this.$oldImage.remove();this.$oldImage=null}a.Fillmore.prototype.onImageLoad.apply(this,arguments);this.resize()},resize:function(){if(this.$imgEl&&this.imageLoaded){try{var c=this.calculateStretchedSizeAndOffsets();var b={left:"-"+c.offsetLeft+"px",top:"-"+c.offsetTop+"px"};this.$fillmoreEl.width(c.stretchedWidth).height(c.stretchedHeight);this.$imgEl.width(c.stretchedWidth).height(c.stretchedHeight).css(b)}catch(d){}}},destroy:function(){a(window).unbind("resize",this.resizeProxy);a.Fillmore.prototype.destroy.apply(this,arguments)}})})(jQuery);(function(b){var a={init:function(h){for(var f=0,c=this.length;f<c;f++){var g=this[f],e=b(g),d=e.data("fillmore");if(!d){if((b.Fillmore.useCss3&&!h.noCss3)||h.forceCss3){d=new b.FillmoreCss3(g)}else{d=new b.FillmoreImageStretch(g)}e.data("fillmore",d)}d.updateSettings(h);d.showImage(h.src)}return this},getSrc:function(){var d=this[0],c;if(d&&(c=b(d).data("fillmore"))){return c.getSrc()}else{return undefined}},getImageSize:function(){var d=this[0],c;if(d&&(c=b(d).data("fillmore"))){return c.getImageSize()}else{return undefined}},getViewableImageArea:function(){var d=this[0],c;if(d&&(c=b(d).data("fillmore"))){return c.getViewableImageArea()}else{return undefined}},isLoaded:function(){var d=this[0],c;if(d&&(c=b(d).data("fillmore"))){return c.isLoaded()}else{return false}},imageIsLoaded:function(){var d=this[0],c;if(d&&(c=b(d).data("fillmore"))){return c.imageIsLoaded()}else{return false}},imageIsVisible:function(){var d=this[0],c;if(d&&(c=b(d).data("fillmore"))){return c.imageIsVisible()}else{return false}},resize:function(){for(var f=0,c=this.length;f<c;f++){var e=b(this[f]),d=e.data("fillmore");if(d){d.resize()}}return this},destroy:function(){for(var f=0,c=this.length;f<c;f++){var e=b(this[f]),d=e.data("fillmore");if(d){d.destroy();e.removeData("fillmore")}}return this}};b.fn.fillmore=function(c){if(typeof c==="string"&&a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return a.init.apply(this,arguments)}else{b.error("Method '"+c+"' does not exist on Fillmore.")}}};b.fillmore=function(c){return b("body").fillmore(c)}})(jQuery);